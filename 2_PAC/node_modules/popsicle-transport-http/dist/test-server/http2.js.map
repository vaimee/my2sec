{"version":3,"file":"http2.js","sourceRoot":"","sources":["../../src/test-server/http2.ts"],"names":[],"mappings":";;;AAAA,iCAKe;AACf,2BAAkC;AAClC,+BAA4B;AAC5B,6BAA0B;AAE1B,MAAM,GAAG,GAAG,CAAC,GAAuB,EAAE,GAAwB,EAAE,EAAE;;IAChE,MAAM,GAAG,GAAG,IAAI,SAAG,CAAC,MAAA,GAAG,CAAC,GAAG,mCAAI,EAAE,EAAE,kBAAkB,CAAC,CAAC;IAEvD,IAAI,GAAG,CAAC,QAAQ,KAAK,QAAQ,EAAE;QAC7B,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,OAAO;KACR;IAED,IAAI,GAAG,CAAC,QAAQ,KAAK,UAAU,EAAE;QAC/B,OAAO;KACR;IAED,IAAI,GAAG,CAAC,QAAQ,KAAK,WAAW,EAAE;QAChC,GAAG,CAAC,SAAS,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAAC;QACpC,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QAEpB,UAAU,CAAC;YACT,IAAI,GAAG,CAAC,OAAO;gBAAE,OAAO;YAExB,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YACpB,GAAG,CAAC,GAAG,EAAE,CAAC;QACZ,CAAC,EAAE,GAAG,CAAC,CAAC;QAER,OAAO;KACR;IAED,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;AACrB,CAAC,CAAC;AAEW,QAAA,MAAM,GAAG,oBAAY,CAAC,GAAG,CAAC,CAAC;AAE3B,QAAA,SAAS,GAAG,0BAAkB,CACzC;IACE,GAAG,EAAE,iBAAY,CAAC,WAAI,CAAC,SAAS,EAAE,wBAAwB,CAAC,CAAC;IAC5D,IAAI,EAAE,iBAAY,CAAC,WAAI,CAAC,SAAS,EAAE,wBAAwB,CAAC,CAAC;IAC7D,EAAE,EAAE,iBAAY,CAAC,WAAI,CAAC,SAAS,EAAE,oBAAoB,CAAC,CAAC;IACvD,UAAU,EAAE,IAAI;CACjB,EACD,GAAG,CACJ,CAAC","sourcesContent":["import {\n  createServer,\n  createSecureServer,\n  Http2ServerRequest,\n  Http2ServerResponse,\n} from \"http2\";\nimport { readFileSync } from \"fs\";\nimport { join } from \"path\";\nimport { URL } from \"url\";\n\nconst app = (req: Http2ServerRequest, res: Http2ServerResponse) => {\n  const url = new URL(req.url ?? \"\", \"http://localhost\");\n\n  if (url.pathname === \"/close\") {\n    res.destroy();\n    return;\n  }\n\n  if (url.pathname === \"/timeout\") {\n    return;\n  }\n\n  if (url.pathname === \"/download\") {\n    res.setHeader(\"Content-Length\", 12);\n    res.write(\"hello \");\n\n    setTimeout(function () {\n      if (req.aborted) return;\n\n      res.write(\"world!\");\n      res.end();\n    }, 200);\n\n    return;\n  }\n\n  res.end(\"Success\");\n};\n\nexport const server = createServer(app);\n\nexport const tlsServer = createSecureServer(\n  {\n    key: readFileSync(join(__dirname, \"support/server-key.pem\")),\n    cert: readFileSync(join(__dirname, \"support/server-crt.pem\")),\n    ca: readFileSync(join(__dirname, \"support/ca-crt.pem\")),\n    allowHTTP1: true,\n  },\n  app\n);\n"]}